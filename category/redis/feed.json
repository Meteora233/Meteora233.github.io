{
    "version": "https://jsonfeed.org/version/1",
    "title": "Luk's Blog • All posts by \"redis\" category",
    "description": "",
    "home_page_url": "https://Meteora233.github.io",
    "items": [
        {
            "id": "https://meteora233.github.io/2023/11/18/computer-science/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis%E5%AD%A6%E4%B9%A0/redis%E5%AE%9E%E8%B7%B5%E4%BD%BF%E7%94%A8/",
            "url": "https://meteora233.github.io/2023/11/18/computer-science/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis%E5%AD%A6%E4%B9%A0/redis%E5%AE%9E%E8%B7%B5%E4%BD%BF%E7%94%A8/",
            "title": "redis实践使用",
            "date_published": "2023-11-17T16:00:00.000Z",
            "content_html": "<h1 id=\"三种特殊数据类型\"><a href=\"#三种特殊数据类型\" class=\"headerlink\" title=\"三种特殊数据类型\"></a>三种特殊数据类型</h1><h2 id=\"geospatial-地理位置\"><a href=\"#geospatial-地理位置\" class=\"headerlink\" title=\"geospatial 地理位置\"></a>geospatial 地理位置</h2><blockquote>\n<p>朋友的定位，附近的人，打车距离计算</p>\n</blockquote>\n<ul>\n<li>可以推算两地之间的距离，计算方圆几里的人<br>windows 还没这玩意再说吧</li>\n</ul>\n<h2 id=\"Bitmap\"><a href=\"#Bitmap\" class=\"headerlink\" title=\"Bitmap\"></a>Bitmap</h2><blockquote>\n<p>位存储</p>\n</blockquote>\n<ol>\n<li>统计用户信息，活跃，不活跃！登录，未登录！打卡，365 打卡！两个状态的都可以使用位图</li>\n<li>使用二进制位来进行计算，只有 0 和 1 两种状态</li>\n<li>365 天&#x3D;365bit 1 字节&#x3D;8bit 46 个字节</li>\n</ol>\n<h2 id=\"例子\"><a href=\"#例子\" class=\"headerlink\" title=\"例子\"></a>例子</h2><p>使用 bitmap 来记录周一到周日打卡情况<br>周一:0 周二：0 周三：1 周四：0 周五：1 周六：1 周日：1</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 存放打卡记录</span></span><br><span class=\"line\">127.0.0.1:6379&gt; setbit sign 0 0</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; setbit sign 1 0</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 0</span><br><span class=\"line\">127.0.0.1:6379&gt; setbit sign 2 0</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 0</span><br><span class=\"line\">127.0.0.1:6379&gt; setbit sign 3 1</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 0</span><br><span class=\"line\">127.0.0.1:6379&gt; setbit sign 4 0</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 0</span><br><span class=\"line\">127.0.0.1:6379&gt; setbit sign 5 1</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 0</span><br><span class=\"line\">127.0.0.1:6379&gt; setbit sign 6 1</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 0</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看某天是否打卡</span></span><br><span class=\"line\">127.0.0.1:6379&gt; getbit sign 3</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; getbit sign 4</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 0</span><br><span class=\"line\"><span class=\"comment\"># 统计打卡天数</span></span><br><span class=\"line\">127.0.0.1:6379&gt; bitcount sign <span class=\"comment\">#统计打卡天数</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 3</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"事务\"><a href=\"#事务\" class=\"headerlink\" title=\"事务\"></a>事务</h1><p><strong>redis 单条命令是保证原子性的，但是事务不保证原子性!</strong><br><strong>redis 没有隔离级别的概念</strong><br>Redis 事务本质: 一组命令的集合 ！一个事务中的所有命令都会被序列化，在事务执行的过程中，会按照顺序执行</p>\n<blockquote>\n<p>特性</p>\n</blockquote>\n<ol>\n<li>一次性</li>\n<li>顺序性</li>\n<li>排他性 （不允许被别的干扰）</li>\n<li>所有的命令在事务中，并没有直接被执行！只有在发起执行命令的时候才会执行！Exec<br>—- 队列 set set set 执行 —-<blockquote>\n<p>阶段</p>\n</blockquote>\n</li>\n</ol>\n<ul>\n<li>开启事务(multi)</li>\n<li>命令入队</li>\n<li>执行事务(exec)</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; multi <span class=\"comment\"># 开启事务</span></span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; <span class=\"built_in\">set</span> k1 v1</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\">127.0.0.1:6379&gt; <span class=\"built_in\">set</span> k2 v2</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\">127.0.0.1:6379&gt; get k2</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\">127.0.0.1:6379&gt; <span class=\"built_in\">exec</span> <span class=\"comment\"># 执行</span></span><br><span class=\"line\">1) OK</span><br><span class=\"line\">2) OK</span><br><span class=\"line\">3) <span class=\"string\">&quot;v2&quot;</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>放弃事务</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; multi</span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; lpush list aaa</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\">127.0.0.1:6379&gt; lpush list bbb</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\">127.0.0.1:6379&gt; LREM list 1 aaa</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\">127.0.0.1:6379&gt; lpop list</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\">127.0.0.1:6379&gt; discard <span class=\"comment\"># 放弃事务</span></span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; lrange list 0 -1 <span class=\"comment\"># 事务队列中的命令都不会被执行</span></span><br><span class=\"line\">(empty list or <span class=\"built_in\">set</span>)</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>编译型异常（代码有问题！命令有错），事务中所有的命令都不会被执行</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; multi</span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; <span class=\"built_in\">set</span> k1 v1</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\">127.0.0.1:6379&gt; <span class=\"built_in\">set</span> k2 v2</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\">127.0.0.1:6379&gt; getset k3 <span class=\"comment\"># 错误的命令</span></span><br><span class=\"line\">(error) ERR wrong number of arguments <span class=\"keyword\">for</span> <span class=\"string\">&#x27;getset&#x27;</span> <span class=\"built_in\">command</span></span><br><span class=\"line\">127.0.0.1:6379&gt; <span class=\"built_in\">set</span> k4 v4</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\">127.0.0.1:6379&gt; <span class=\"built_in\">exec</span> <span class=\"comment\"># 执行事务报错</span></span><br><span class=\"line\">(error) EXECABORT Transaction discarded because of previous errors.</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>运行中异常(1&#x2F;0) 如果事务队列中存在语法问题，那么执行命令的时候，其他命令是可以正常运行的，错误命令抛出异常</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; <span class=\"built_in\">set</span> k1 <span class=\"string\">&quot;hello&quot;</span></span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; multi</span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; incr k1</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\">127.0.0.1:6379&gt; <span class=\"built_in\">set</span> k2 v2</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\">127.0.0.1:6379&gt; get k2</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\">127.0.0.1:6379&gt; <span class=\"built_in\">exec</span></span><br><span class=\"line\">1) (error) ERR value is not an <span class=\"built_in\">integer</span> or out of range</span><br><span class=\"line\">2) OK</span><br><span class=\"line\">3) <span class=\"string\">&quot;v2&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"锁\"><a href=\"#锁\" class=\"headerlink\" title=\"锁\"></a>锁</h1><ol>\n<li>悲观锁</li>\n</ol>\n<ul>\n<li>什么时候都会出问题就无论什么都加锁</li>\n</ul>\n<ol start=\"2\">\n<li>乐观锁</li>\n</ol>\n<ul>\n<li>认为什么时候都不会出现问题，所以不会上锁！ 更新数据的 时候判断，在此期间是否有人修改过这个数据</li>\n<li>获取 version</li>\n<li>更新的时候比较 version</li>\n</ul>\n<blockquote>\n<p>性能测试</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; <span class=\"built_in\">set</span> money 100</span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; <span class=\"built_in\">set</span> out 0</span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; watch money <span class=\"comment\"># 监视money</span></span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; multi <span class=\"comment\"># 事务正常结束，数据期间没有发生任何变动，</span></span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; decrby money 20</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\">127.0.0.1:6379&gt; incrby out 20</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\">127.0.0.1:6379&gt; <span class=\"built_in\">exec</span></span><br><span class=\"line\">1) (<span class=\"built_in\">integer</span>) 80</span><br><span class=\"line\">2) (<span class=\"built_in\">integer</span>) 20</span><br></pre></td></tr></table></figure>\n\n<p>测试多线程修改值，使用 watch 可以当作 redis 的乐观锁操作</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; watch money <span class=\"comment\"># 监视money</span></span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; multi</span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; incrby out 10</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\">127.0.0.1:6379&gt; decrby money 10</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\">127.0.0.1:6379&gt; <span class=\"built_in\">exec</span> <span class=\"comment\">#执行之前 另一个线程修改了money的值，这个时候会导致事务执行失败</span></span><br><span class=\"line\">(nil)</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> 127.0.0.1:6379&gt; unwatch <span class=\"comment\"># 发现事务执行失败就先解锁</span></span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; watch money <span class=\"comment\"># 获取最新的值，再次监视，select version</span></span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; multi</span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; decrby money 1</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\">127.0.0.1:6379&gt; incrby out 1</span><br><span class=\"line\">QUEUED</span><br><span class=\"line\">127.0.0.1:6379&gt; <span class=\"built_in\">exec</span> <span class=\"comment\"># 比对监视的值是否发生变化，如果没有发生变化，那么可以执行成功，如果变了就执行失败</span></span><br><span class=\"line\">1) (<span class=\"built_in\">integer</span>) 989</span><br><span class=\"line\">2) (<span class=\"built_in\">integer</span>) 991</span><br><span class=\"line\">127.0.0.1:6379&gt;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"SpringBoot-整合\"><a href=\"#SpringBoot-整合\" class=\"headerlink\" title=\"SpringBoot 整合\"></a>SpringBoot 整合</h1><p>springboot 操作数据: spring-data jpa jdbc mongodb redis<br>jedis:采用的直连，多个线程操作的话，是不安全的，如果想要避免不安全，使用 Jedi 是 pool 连接池！ 更像 BIO 模式<br>lettuce：采用 netty，实例可以再多个线程进行共享，不存在线程不安全的情况！可以减少线程数量，NIO 模式</p>\n<h2 id=\"源码分析\"><a href=\"#源码分析\" class=\"headerlink\" title=\"源码分析\"></a>源码分析</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 自动配置类</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">RedisAutoConfiguration</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">RedisAutoConfiguration</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"meta\">@ConditionalOnMissingBean( name = &#123;&quot;redisTemplate&quot;&#125;)</span> <span class=\"comment\">//可以定义一个redistemplate来替换</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> RedisTemplate&lt;Object, Object&gt; <span class=\"title function_\">redisTemplate</span><span class=\"params\">(RedisConnectionFactory redisConnectionFactory)</span> <span class=\"keyword\">throws</span> UnknownHostException &#123;</span><br><span class=\"line\">      <span class=\"comment\">// 默认的redisTemplate 没有过多的设置，redis对象保存需要序列化</span></span><br><span class=\"line\">      <span class=\"comment\">// 两个泛型都是object类型，后面使用需要强制转换&lt;String,Object&gt;</span></span><br><span class=\"line\">        RedisTemplate&lt;Object, Object&gt; template = <span class=\"keyword\">new</span> <span class=\"title class_\">RedisTemplate</span>();</span><br><span class=\"line\">        template.setConnectionFactory(redisConnectionFactory);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> template;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"meta\">@ConditionalOnMissingBean</span></span><br><span class=\"line\">    <span class=\"comment\">// 由于String类型是redis最常用的类型，所以单独提出来使用</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> StringRedisTemplate <span class=\"title function_\">stringRedisTemplate</span><span class=\"params\">(RedisConnectionFactory redisConnectionFactory)</span> <span class=\"keyword\">throws</span> UnknownHostException &#123;</span><br><span class=\"line\">        <span class=\"type\">StringRedisTemplate</span> <span class=\"variable\">template</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">StringRedisTemplate</span>();</span><br><span class=\"line\">        template.setConnectionFactory(redisConnectionFactory);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> template;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">```</span><br><span class=\"line\"></span><br><span class=\"line\">``java</span><br><span class=\"line\"> <span class=\"meta\">@Autowired</span></span><br><span class=\"line\"> <span class=\"keyword\">private</span> RedisTemplate redisTemplate;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"meta\">@Test</span></span><br><span class=\"line\"> <span class=\"keyword\">void</span> <span class=\"title function_\">contextLoads</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">     <span class=\"comment\">//操作不同的数据类型</span></span><br><span class=\"line\">     <span class=\"comment\">// opsForValue 类String</span></span><br><span class=\"line\">     redisTemplate.opsForValue().set(<span class=\"string\">&quot;mykey&quot;</span>,<span class=\"string\">&quot;aaa&quot;</span>);</span><br><span class=\"line\">     System.out.println(redisTemplate.opsForValue().get(<span class=\"string\">&quot;mykey&quot;</span>));</span><br><span class=\"line\">     redisTemplate.opsForHash();</span><br><span class=\"line\">     redisTemplate.opsForList();</span><br><span class=\"line\">     <span class=\"comment\">// 获取连接对象</span></span><br><span class=\"line\">     <span class=\"type\">RedisConnection</span> <span class=\"variable\">connection</span> <span class=\"operator\">=</span> redisTemplate.getConnectionFactory().getConnection();</span><br><span class=\"line\">     connection.flushDb();</span><br><span class=\"line\">     connection.flushAll();</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"> &#125;</span><br><span class=\"line\">```</span><br><span class=\"line\">``` yml</span><br><span class=\"line\">  redis:</span><br><span class=\"line\">    database: <span class=\"number\">1</span></span><br><span class=\"line\">    host: <span class=\"number\">127.0</span><span class=\"number\">.0</span><span class=\"number\">.1</span></span><br><span class=\"line\">    port: <span class=\"number\">6379</span></span><br><span class=\"line\">    timeout: <span class=\"number\">6000</span>  # 连接超时时长（毫秒）</span><br><span class=\"line\"></span><br><span class=\"line\">redis-lock:</span><br><span class=\"line\">  config:</span><br><span class=\"line\">    # 锁过期时间，单位：秒</span><br><span class=\"line\">    expireTime: <span class=\"number\">10</span></span><br><span class=\"line\">    # 获取自旋锁失败时等待超时时间，单位：秒</span><br><span class=\"line\">    waitTime: <span class=\"number\">3</span></span><br><span class=\"line\">    # 获取自旋锁失败时休眠等待时间，单位：毫秒</span><br><span class=\"line\">    sleepTime: <span class=\"number\">500</span></span><br><span class=\"line\"></span><br><span class=\"line\">```</span><br></pre></td></tr></table></figure>\n\n<p><img data-src=\"/image.png\" alt=\"序列化配置\"></p>\n<h2 id=\"编写自己的-config\"><a href=\"#编写自己的-config\" class=\"headerlink\" title=\"编写自己的 config\"></a>编写自己的 config</h2>",
            "tags": []
        },
        {
            "id": "https://meteora233.github.io/2023/11/17/computer-science/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis%E5%AD%A6%E4%B9%A0/redisAPI%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/",
            "url": "https://meteora233.github.io/2023/11/17/computer-science/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis%E5%AD%A6%E4%B9%A0/redisAPI%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/",
            "title": "redisAPI基本使用",
            "date_published": "2023-11-16T16:00:00.000Z",
            "content_html": "<p>note info:<br>第一天学习 课程：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMVM1NHkxUjdTQj9wPTExJnZkX3NvdXJjZT1lZTc2MGJmN2E0ZDg5ZDNlZTkyZjRmODNmM2E2ODJjOQ==\">Redis</span></p>\n<h1 id=\"redis-概念\"><a href=\"#redis-概念\" class=\"headerlink\" title=\"redis 概念\"></a>redis 概念</h1><h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><p>redis 是单线程的，基于内存操作，cpu 不是 redis 的性能瓶颈，redis 的瓶颈是机器的内存和网络的带宽，使用单线程实现。可用作数据库，高速缓存和消息队列代理</p>\n<h3 id=\"单线程快速的原因\"><a href=\"#单线程快速的原因\" class=\"headerlink\" title=\"单线程快速的原因\"></a>单线程快速的原因</h3><ol>\n<li>redis 是将所有的数据存放在内存中，所以试用单线程去操作效率是最高的 而多线程（cpu 上下文切换会消耗时间），对于内存系统来说，没有上下文切换效率是最高的！多次读写都是再一个 cpu 上</li>\n<li>C 语言编写的</li>\n</ol>\n<h1 id=\"RedisKey-的基本命令\"><a href=\"#RedisKey-的基本命令\" class=\"headerlink\" title=\"RedisKey 的基本命令\"></a>RedisKey 的基本命令</h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379[15]&gt; <span class=\"keyword\">select</span> 0 <span class=\"comment\">#选择0号数据库</span></span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; dbsize <span class=\"comment\">#当前数据库的大小</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 17</span><br><span class=\"line\">127.0.0.1:6379&gt; get name <span class=\"comment\">#按照键寻找值</span></span><br><span class=\"line\"><span class=\"string\">&quot;flower&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; <span class=\"built_in\">set</span> password 123 <span class=\"comment\">#存放值</span></span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; keys *  <span class=\"comment\">#查看数据库所有的key</span></span><br><span class=\"line\">1) <span class=\"string\">&quot;sys_dict:sys_notice_type&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;sys_dict:sys_user_sex&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;sys_dict:sys_show_hide&quot;</span></span><br><span class=\"line\">4) <span class=\"string\">&quot;sys_dict:sys_job_group&quot;</span></span><br><span class=\"line\">5) <span class=\"string\">&quot;sys_config:sys.index.sideTheme&quot;</span></span><br><span class=\"line\">6) <span class=\"string\">&quot;sys_dict:sys_normal_disable&quot;</span></span><br><span class=\"line\">7) <span class=\"string\">&quot;sys_dict:sys_common_status&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"清除数据库\"><a href=\"#清除数据库\" class=\"headerlink\" title=\"清除数据库\"></a>清除数据库</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; flushdb #清除当前数据库</span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; keys *</span><br><span class=\"line\">(empty list or set)</span><br><span class=\"line\">127.0.0.1:6379&gt; flushAll #清除当前数据库</span><br><span class=\"line\">OK</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; exists age <span class=\"comment\"># 判断是否存在</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; move age 1 <span class=\"comment\"># 移除key</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; EXPIRE name 10 <span class=\"comment\">#设置过期时间为十秒</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; ttl name <span class=\"comment\">#查看当前key的剩余时间</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 7</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"五大数据类型\"><a href=\"#五大数据类型\" class=\"headerlink\" title=\"五大数据类型\"></a>五大数据类型</h1><h2 id=\"String-字符串类型\"><a href=\"#String-字符串类型\" class=\"headerlink\" title=\"String 字符串类型\"></a>String 字符串类型</h2><h3 id=\"追加操作\"><a href=\"#追加操作\" class=\"headerlink\" title=\"追加操作\"></a>追加操作</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; <span class=\"built_in\">set</span> name meteor</span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; <span class=\"built_in\">type</span> name <span class=\"comment\"># 查看当前key的类型</span></span><br><span class=\"line\">string</span><br><span class=\"line\">127.0.0.1:6379&gt; APPEND name <span class=\"string\">&quot;233&quot;</span> <span class=\"comment\"># 追加字符串 要是原字符串不存在 相当于set</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 9</span><br><span class=\"line\">127.0.0.1:6379&gt; get name</span><br><span class=\"line\"><span class=\"string\">&quot;meteor233&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; STRLEN name <span class=\"comment\">#获取字符串长度</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 9</span><br><span class=\"line\"><span class=\"comment\">##############################################</span></span><br><span class=\"line\"><span class=\"comment\"># i++</span></span><br><span class=\"line\">步长 i+=1</span><br><span class=\"line\">127.0.0.1:6379&gt; <span class=\"built_in\">set</span> views 0 <span class=\"comment\">#初始化浏览量0</span></span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; get views</span><br><span class=\"line\"><span class=\"string\">&quot;0&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; incr views  <span class=\"comment\"># 自增1</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; incr views</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 2</span><br><span class=\"line\">127.0.0.1:6379&gt; get views</span><br><span class=\"line\"><span class=\"string\">&quot;2&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; decr views <span class=\"comment\"># 自减1</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; get views</span><br><span class=\"line\"><span class=\"string\">&quot;1&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; INCRBY views 10 <span class=\"comment\">#自增10</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 11</span><br><span class=\"line\">127.0.0.1:6379&gt; DECRBY views  10 <span class=\"comment\">#自减10</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\"><span class=\"comment\">##############################################</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"类插入操作\"><a href=\"#类插入操作\" class=\"headerlink\" title=\"类插入操作\"></a>类插入操作</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    字符串范围  range</span><br><span class=\"line\">    127.0.0.1:6379&gt; GETRANGE name 0 -1</span><br><span class=\"line\">    <span class=\"string\">&quot;meteor233&quot;</span></span><br><span class=\"line\">    127.0.0.1:6379&gt; GETRANGE name 0 -2</span><br><span class=\"line\">    <span class=\"string\">&quot;meteor23&quot;</span></span><br><span class=\"line\">    127.0.0.1:6379&gt; SETRANGE name 1 os <span class=\"comment\">#替换索引位置为1开始的字符串</span></span><br><span class=\"line\">    (<span class=\"built_in\">integer</span>) 9</span><br><span class=\"line\">    127.0.0.1:6379&gt; get name</span><br><span class=\"line\">    <span class=\"string\">&quot;moseor233&quot;</span></span><br><span class=\"line\">    <span class=\"comment\">##############################################</span></span><br><span class=\"line\">    setex( <span class=\"built_in\">set</span> with expire) <span class=\"comment\"># 设置过期时间</span></span><br><span class=\"line\">    setnx( <span class=\"built_in\">set</span> <span class=\"keyword\">if</span> not exist) <span class=\"comment\"># 不存在再设置（在分布式锁中会常常使用）</span></span><br><span class=\"line\"></span><br><span class=\"line\">    127.0.0.1:6379&gt; setex name 30 <span class=\"string\">&quot;hello&quot;</span> <span class=\"comment\"># 存在键  修改值并且设置设置过期时间</span></span><br><span class=\"line\">    OK</span><br><span class=\"line\"></span><br><span class=\"line\">    127.0.0.1:6379&gt; setnx mykey <span class=\"string\">&#x27;redis&#x27;</span> <span class=\"comment\"># 如果mykey不存在创建mykey</span></span><br><span class=\"line\">    (<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\"></span><br><span class=\"line\">    127.0.0.1:6379&gt; setnx mykey <span class=\"string\">&quot;mongoDB&quot;</span> <span class=\"comment\">#如果mykey存在，就创建失败</span></span><br><span class=\"line\">    (<span class=\"built_in\">integer</span>) 0</span><br><span class=\"line\">    127.0.0.1:6379&gt; get mykey</span><br><span class=\"line\">    <span class=\"string\">&quot;redis&quot;</span></span><br><span class=\"line\">    <span class=\"comment\">##############################################</span></span><br><span class=\"line\">    <span class=\"comment\"># 批量添加 批量获取</span></span><br><span class=\"line\">    127.0.0.1:6379&gt; mset k1 v1 k2 v2 k3 v3 <span class=\"comment\">#同时设置多个值</span></span><br><span class=\"line\">    OK</span><br><span class=\"line\">    127.0.0.1:6379&gt; keys *</span><br><span class=\"line\">    1) <span class=\"string\">&quot;k3&quot;</span></span><br><span class=\"line\">    2) <span class=\"string\">&quot;k1&quot;</span></span><br><span class=\"line\">    3) <span class=\"string\">&quot;k2&quot;</span></span><br><span class=\"line\">    127.0.0.1:6379&gt; mget k1 k2 k3 <span class=\"comment\"># 同时获取多个值</span></span><br><span class=\"line\">    1) <span class=\"string\">&quot;v1&quot;</span></span><br><span class=\"line\">    2) <span class=\"string\">&quot;v2&quot;</span></span><br><span class=\"line\">    127.0.0.1:6379&gt; msetnx k1 v1 k4 v4 <span class=\"comment\">#msetnx 是一个原子性操作，要么一起成功 要么一起失败</span></span><br><span class=\"line\">    (<span class=\"built_in\">integer</span>) 0</span><br><span class=\"line\">    127.0.0.1:6379&gt; keys *</span><br><span class=\"line\">    1) <span class=\"string\">&quot;k3&quot;</span></span><br><span class=\"line\">    2) <span class=\"string\">&quot;k1&quot;</span></span><br><span class=\"line\">    3) <span class=\"string\">&quot;k2&quot;</span></span><br><span class=\"line\">    127.0.0.1:6379&gt; get k4</span><br><span class=\"line\">    (nil)</span><br><span class=\"line\"><span class=\"comment\">##############################################</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"使用字符串保存-json-对象\"><a href=\"#使用字符串保存-json-对象\" class=\"headerlink\" title=\"使用字符串保存 json 对象\"></a>使用字符串保存 json 对象</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#设置一个user：1 对象值为json字符来保存一个对象 存放的结果类似于这个</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># user:1 &#123;name:zhangsan,age:12&#125;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; mset user:1:name zhangsan user:1:age 2</span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; mget user:1:name user:1:age</span><br><span class=\"line\">1) <span class=\"string\">&quot;zhangsan&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;2&quot;</span></span><br><span class=\"line\"><span class=\"comment\">##############################################</span></span><br><span class=\"line\">getset <span class=\"comment\">#先get然后再set</span></span><br><span class=\"line\">127.0.0.1:6379&gt; getset db redis <span class=\"comment\">#如果不存在值则返回 nil</span></span><br><span class=\"line\">(nil)</span><br><span class=\"line\">127.0.0.1:6379&gt; get db</span><br><span class=\"line\"><span class=\"string\">&quot;redis&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; getset db mongodb <span class=\"comment\">#如果存在值先返回后覆盖</span></span><br><span class=\"line\"><span class=\"string\">&quot;redis&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; get db</span><br><span class=\"line\"><span class=\"string\">&quot;mongodb&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"使用场景类似于\"><a href=\"#使用场景类似于\" class=\"headerlink\" title=\"使用场景类似于\"></a>使用场景类似于</h3><ul>\n<li>计数器</li>\n<li>统计多单位的数量 uid:{id}:follower 粉丝数</li>\n<li>粉丝数</li>\n<li>对象缓存存储</li>\n</ul>\n<h2 id=\"List-字符串类型\"><a href=\"#List-字符串类型\" class=\"headerlink\" title=\"List 字符串类型\"></a>List 字符串类型</h2><h3 id=\"头尾添加值\"><a href=\"#头尾添加值\" class=\"headerlink\" title=\"头尾添加值\"></a>头尾添加值</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; lpush list one <span class=\"comment\"># 将一个值或多个值插入到列表头部（栈）</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; lpush list two</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 2</span><br><span class=\"line\">127.0.0.1:6379&gt; lpush list three</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 3</span><br><span class=\"line\">127.0.0.1:6379&gt; LRANGE list 0 -1</span><br><span class=\"line\">1) <span class=\"string\">&quot;three&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;two&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;one&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; RPUSH list right <span class=\"comment\"># 将一个值或多个值插入到列表尾部（队列）</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 4</span><br><span class=\"line\">127.0.0.1:6379&gt; LRANGE list 0 -1</span><br><span class=\"line\">1) <span class=\"string\">&quot;three&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;two&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;one&quot;</span></span><br><span class=\"line\">4) <span class=\"string\">&quot;right&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"更新值\"><a href=\"#更新值\" class=\"headerlink\" title=\"更新值\"></a>更新值</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#  lset 将指定下标的值替换成另外一个值</span></span><br><span class=\"line\">127.0.0.1:6379&gt; lpush list value1</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; LRANGE list 0 0</span><br><span class=\"line\">1) <span class=\"string\">&quot;value1&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; lset list 0 item <span class=\"comment\">#设置列表的指定位置为新的值</span></span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; LRANGE list 0 0</span><br><span class=\"line\">1) <span class=\"string\">&quot;item&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; lset list 1 other <span class=\"comment\"># 不存在会报错</span></span><br><span class=\"line\">(error) ERR index out of range</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"在指定位置插入值\"><a href=\"#在指定位置插入值\" class=\"headerlink\" title=\"在指定位置插入值\"></a>在指定位置插入值</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; rpush mylist <span class=\"string\">&quot;hello&quot;</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; rpush mylist <span class=\"string\">&quot;world&quot;</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 2</span><br><span class=\"line\">127.0.0.1:6379&gt; LINSERT mylist before <span class=\"string\">&quot;world&quot;</span> <span class=\"string\">&quot;other&quot;</span> <span class=\"comment\"># 在world单词前面添加other</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 3</span><br><span class=\"line\">127.0.0.1:6379&gt; LRANGE mylist 0 -1</span><br><span class=\"line\">1) <span class=\"string\">&quot;hello&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;other&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;world&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; LINSERT mylist after <span class=\"string\">&quot;world&quot;</span> <span class=\"string\">&quot;!!!&quot;</span> <span class=\"comment\">#在world后添加</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 4</span><br><span class=\"line\">127.0.0.1:6379&gt; LRANGE mylist 0 -1</span><br><span class=\"line\">1) <span class=\"string\">&quot;hello&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;other&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;world&quot;</span></span><br><span class=\"line\">4) <span class=\"string\">&quot;!!!&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"移除-list-的值\"><a href=\"#移除-list-的值\" class=\"headerlink\" title=\"移除 list 的值\"></a>移除 list 的值</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; lpop list <span class=\"comment\"># 移除list的 第一个元素</span></span><br><span class=\"line\"><span class=\"string\">&quot;three&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; LRANGE list 0 -1</span><br><span class=\"line\">1) <span class=\"string\">&quot;two&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;one&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;right&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; rpop list <span class=\"comment\">#移除list的最后一个元素</span></span><br><span class=\"line\"><span class=\"string\">&quot;right&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; LRANGE list 0 -1</span><br><span class=\"line\">1) <span class=\"string\">&quot;two&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;one&quot;</span></span><br><span class=\"line\"><span class=\"comment\"># 移除指定值</span></span><br><span class=\"line\">127.0.0.1:6379&gt; lpush list three</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 4</span><br><span class=\"line\">127.0.0.1:6379&gt; LRANGE list 0 -1</span><br><span class=\"line\">1) <span class=\"string\">&quot;three&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;three&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;two&quot;</span></span><br><span class=\"line\">4) <span class=\"string\">&quot;one&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; LREM list 1 one <span class=\"comment\"># 移除list中的1个one</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; LRANGE list 0 -1</span><br><span class=\"line\">1) <span class=\"string\">&quot;three&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;three&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;two&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; LREM list 2 three <span class=\"comment\"># 移除list中的2个three</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 2</span><br><span class=\"line\">127.0.0.1:6379&gt; LRANGE list 0 -1</span><br><span class=\"line\">1) <span class=\"string\">&quot;two&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"切片-复制\"><a href=\"#切片-复制\" class=\"headerlink\" title=\"切片 复制\"></a>切片 复制</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; Rpush list hello</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; Rpush list world</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 2</span><br><span class=\"line\">127.0.0.1:6379&gt; Rpush list hello1</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 3</span><br><span class=\"line\">127.0.0.1:6379&gt; Rpush list hello2</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 4</span><br><span class=\"line\">127.0.0.1:6379&gt; Rpush list hello3</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 5</span><br><span class=\"line\">127.0.0.1:6379&gt; LREM list 1 world</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; ltrim list 1 2</span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class=\"line\">1) <span class=\"string\">&quot;hello1&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;hello2&quot;</span></span><br><span class=\"line\"><span class=\"comment\">#########################################</span></span><br><span class=\"line\"><span class=\"comment\">#移除列表最后一个元素，将他移动到新的列表中</span></span><br><span class=\"line\">127.0.0.1:6379&gt; rpoplpush mylist myOtherList <span class=\"comment\">#把原列表的最后一个值移动到另一个列表</span></span><br><span class=\"line\"><span class=\"string\">&quot;hello2&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; LRANGE mylist 0 -1 <span class=\"comment\">#查看原列表</span></span><br><span class=\"line\">1) <span class=\"string\">&quot;hello&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;hello1&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; LRANGE myOtherList 0 -1 <span class=\"comment\">#查看新列表</span></span><br><span class=\"line\">1) <span class=\"string\">&quot;hello2&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"获取-list-中的值\"><a href=\"#获取-list-中的值\" class=\"headerlink\" title=\"获取 list 中的值\"></a>获取 list 中的值</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; lindex list 1 <span class=\"comment\"># 下标为1的元素</span></span><br><span class=\"line\"><span class=\"string\">&quot;one&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; lindex list 0</span><br><span class=\"line\"><span class=\"string\">&quot;two&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; LLEN list <span class=\"comment\">#获取长度</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 2</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"小结\"><a href=\"#小结\" class=\"headerlink\" title=\"小结\"></a>小结</h3><ul>\n<li>他实际上是一个链表，before node after，left right 都可以插入值</li>\n<li>如果 key 不存在，创建新链表</li>\n<li>如果 key 存在，新建内容</li>\n<li>如果移除所有值，空链表，也表示不存在</li>\n<li>在两边插入或者改动值，效率最高！中间元素，相对来说效率会低<br>消息排队！消息队列（Lpush Rpop），栈（Lpush,Lpop）</li>\n</ul>\n<h2 id=\"Set（集合）\"><a href=\"#Set（集合）\" class=\"headerlink\" title=\"Set（集合）\"></a>Set（集合）</h2><p>set 无序不重复集合。</p>\n<h3 id=\"基础操作\"><a href=\"#基础操作\" class=\"headerlink\" title=\"基础操作\"></a>基础操作</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; sadd myset <span class=\"string\">&quot;hello&quot;</span> <span class=\"comment\">#添加元素</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; sadd myset <span class=\"string\">&quot;abaaba&quot;</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; sadd myset <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; smembers myset <span class=\"comment\">#查看指定set的所有值</span></span><br><span class=\"line\">1) <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;abaaba&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;hello&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; sismember myset hello <span class=\"comment\">#判断某个值是否在set中</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; sismember myset world</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 0</span><br><span class=\"line\">127.0.0.1:6379&gt; sadd myset hello <span class=\"comment\"># 不可添加重复元素</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 0</span><br><span class=\"line\">127.0.0.1:6379&gt; scard myset <span class=\"comment\"># 获取set集合中的个数</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 3</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"移除元素\"><a href=\"#移除元素\" class=\"headerlink\" title=\"移除元素\"></a>移除元素</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; SREM myset hello</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; scard myset</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 2</span><br><span class=\"line\">127.0.0.1:6379&gt; smembers myset</span><br><span class=\"line\">1) <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;abaaba&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"取值\"><a href=\"#取值\" class=\"headerlink\" title=\"取值\"></a>取值</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; srandmember myset <span class=\"comment\"># 随机抽选一个元素</span></span><br><span class=\"line\"><span class=\"string\">&quot;hello5&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; srandmember myset 5 <span class=\"comment\"># 随机抽选 5 个元素</span></span><br><span class=\"line\">1. <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">2. <span class=\"string\">&quot;hello3&quot;</span></span><br><span class=\"line\">3. <span class=\"string\">&quot;hello73&quot;</span></span><br><span class=\"line\">4. <span class=\"string\">&quot;hello5&quot;</span></span><br><span class=\"line\">5. <span class=\"string\">&quot;hello2&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"删除元素\"><a href=\"#删除元素\" class=\"headerlink\" title=\"删除元素\"></a>删除元素</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; smembers myset</span><br><span class=\"line\">1) <span class=\"string\">&quot;abaaba&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;hello3&quot;</span></span><br><span class=\"line\">4) <span class=\"string\">&quot;hello73&quot;</span></span><br><span class=\"line\">5) <span class=\"string\">&quot;hello2&quot;</span></span><br><span class=\"line\">6) <span class=\"string\">&quot;hello5&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; spop myset <span class=\"comment\"># 随机移除元素</span></span><br><span class=\"line\"><span class=\"string\">&quot;hello2&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; spop myset</span><br><span class=\"line\"><span class=\"string\">&quot;hello3&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; smembers myset</span><br><span class=\"line\">1) <span class=\"string\">&quot;abaaba&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;hello73&quot;</span></span><br><span class=\"line\">4) <span class=\"string\">&quot;hello5&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"转移元素\"><a href=\"#转移元素\" class=\"headerlink\" title=\"转移元素\"></a>转移元素</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; smembers myset</span><br><span class=\"line\">1) <span class=\"string\">&quot;abaaba&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;hello73&quot;</span></span><br><span class=\"line\">4) <span class=\"string\">&quot;hello5&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; sadd myset2 set2</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; smove myset myset2 hello5 <span class=\"comment\"># smove source destination member 从原set把指定元素移动到指定的集合</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; smembers myset</span><br><span class=\"line\">1) <span class=\"string\">&quot;abaaba&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;hello73&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; smembers myset2</span><br><span class=\"line\">1) <span class=\"string\">&quot;set2&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;hello5&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"并集差集\"><a href=\"#并集差集\" class=\"headerlink\" title=\"并集差集\"></a>并集差集</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; sadd key1 a</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; sadd key1 b</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; sadd key1 c</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; sadd key2 c</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; sadd key2 d</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; sadd key2 e</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; SDIFF key1 key2 <span class=\"comment\"># 差集</span></span><br><span class=\"line\">1) <span class=\"string\">&quot;b&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;a&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; sinter key1 key2 <span class=\"comment\"># 交集 共同好友可以这样实现</span></span><br><span class=\"line\">1) <span class=\"string\">&quot;c&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; sunion key1 key2 <span class=\"comment\"># 并集</span></span><br><span class=\"line\">1) <span class=\"string\">&quot;e&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;a&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;c&quot;</span></span><br><span class=\"line\">4) <span class=\"string\">&quot;b&quot;</span></span><br><span class=\"line\">5) <span class=\"string\">&quot;d&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Hash（哈希）\"><a href=\"#Hash（哈希）\" class=\"headerlink\" title=\"Hash（哈希）\"></a>Hash（哈希）</h2><p>Map 集合 ，key value</p>\n<h3 id=\"添加删除值\"><a href=\"#添加删除值\" class=\"headerlink\" title=\"添加删除值\"></a>添加删除值</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; hset myhash field1 value <span class=\"comment\"># set 一个具体的key-value</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; hget myhash field1 <span class=\"comment\"># 获取一个字段值</span></span><br><span class=\"line\"><span class=\"string\">&quot;value&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; hmset myhash field1 hello field2 world <span class=\"comment\"># set多个具体key -value</span></span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; hmget myhash field1 field2 <span class=\"comment\"># 获取多个字段值</span></span><br><span class=\"line\">1) <span class=\"string\">&quot;hello&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;world&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; hgetall myhash <span class=\"comment\"># 获取全部的数据</span></span><br><span class=\"line\">1) <span class=\"string\">&quot;field1&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;hello&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;field2&quot;</span></span><br><span class=\"line\">4) <span class=\"string\">&quot;world&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; hdel myhash field1 <span class=\"comment\">#删除hash指定的key字段！对应的value也消失了</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; hgetall myhash</span><br><span class=\"line\">1) <span class=\"string\">&quot;field2&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;world&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; hsetnx myhash field hello <span class=\"comment\"># 不存在才创建</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 0</span><br><span class=\"line\">127.0.0.1:6379&gt; hsetnx myhash field10 hello <span class=\"comment\"># 不存在就创建这个值</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"获取值\"><a href=\"#获取值\" class=\"headerlink\" title=\"获取值\"></a>获取值</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; hmset myhash field1 value1 field2 value2  field4 value4 field3 value3 <span class=\"comment\"># 批量添加</span></span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; hlen myhash <span class=\"comment\"># 获取hash长度</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 4</span><br><span class=\"line\">127.0.0.1:6379&gt; hexists myhash field1 <span class=\"comment\"># 判断是否存在某个key</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; hexists myhash field2</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\"><span class=\"comment\">############</span></span><br><span class=\"line\">127.0.0.1:6379&gt; hkeys myhash <span class=\"comment\"># 获取所有的key</span></span><br><span class=\"line\">1) <span class=\"string\">&quot;field2&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;field1&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;field4&quot;</span></span><br><span class=\"line\">4) <span class=\"string\">&quot;field3&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; hvals myhash <span class=\"comment\"># 获取所有的value</span></span><br><span class=\"line\">1) <span class=\"string\">&quot;value2&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;value1&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;value4&quot;</span></span><br><span class=\"line\">4) <span class=\"string\">&quot;value3&quot;</span>```</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"自增\"><a href=\"#自增\" class=\"headerlink\" title=\"自增\"></a>自增</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; hincrby myhash field 1 <span class=\"comment\"># 设置自增1</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 6</span><br><span class=\"line\">127.0.0.1:6379&gt; hincrby myhash field -1 <span class=\"comment\"># 减少1</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 5</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"hash-变更的数据-user-name-age\"><a href=\"#hash-变更的数据-user-name-age\" class=\"headerlink\" title=\"hash 变更的数据 user name age\"></a>hash 变更的数据 user name age</h3><p><strong>尤其是用户信息</strong></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; hset user:1 name meteor</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; hget user:1 name</span><br><span class=\"line\"><span class=\"string\">&quot;meteor&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"zset-有序集合\"><a href=\"#zset-有序集合\" class=\"headerlink\" title=\"zset(有序集合)\"></a>zset(有序集合)</h2><p>在 set 的基础上添加了一个值,zset k1 score1 v1</p>\n<h3 id=\"添加元素移除元素\"><a href=\"#添加元素移除元素\" class=\"headerlink\" title=\"添加元素移除元素\"></a>添加元素移除元素</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; zadd salary 2500 xiaohong</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; zadd salary 5000 zhangsan</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; zadd salary 500 lisi</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; zrem salary zhangsan <span class=\"comment\"># 移除有序集合中的指定元素</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 1</span><br><span class=\"line\">127.0.0.1:6379&gt; zrange salary 0 -1</span><br><span class=\"line\">1) <span class=\"string\">&quot;lisi&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;xiaohong&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; zcard salary <span class=\"comment\"># 获取有序集合中的个数</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 2</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"按照要求排序\"><a href=\"#按照要求排序\" class=\"headerlink\" title=\"按照要求排序\"></a>按照要求排序</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; zrangebyscore salary -inf +inf <span class=\"comment\"># 显示所有的用户 从小到大</span></span><br><span class=\"line\">1) <span class=\"string\">&quot;lisi&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;xiaohong&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;zhangsan&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; zrevrange salary 0 -1 withscores <span class=\"comment\"># 从大到小</span></span><br><span class=\"line\">1) <span class=\"string\">&quot;xiaohong&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;2500&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;lisi&quot;</span></span><br><span class=\"line\">4) <span class=\"string\">&quot;500&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; zrangebyscore salary -inf +inf withscores <span class=\"comment\"># 显示所有的员工并且附带薪水</span></span><br><span class=\"line\">1) <span class=\"string\">&quot;lisi&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;500&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;xiaohong&quot;</span></span><br><span class=\"line\">4) <span class=\"string\">&quot;2500&quot;</span></span><br><span class=\"line\">5) <span class=\"string\">&quot;zhangsan&quot;</span></span><br><span class=\"line\">6) <span class=\"string\">&quot;5000&quot;</span></span><br><span class=\"line\">127.0.0.1:6379&gt; zrangebyscore salary -inf 2500 withscores <span class=\"comment\"># 显示工资小于两千五的升序排列 并且附带薪水</span></span><br><span class=\"line\">1) <span class=\"string\">&quot;lisi&quot;</span></span><br><span class=\"line\">2) <span class=\"string\">&quot;500&quot;</span></span><br><span class=\"line\">3) <span class=\"string\">&quot;xiaohong&quot;</span></span><br><span class=\"line\">4) <span class=\"string\">&quot;2500&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"取值-1\"><a href=\"#取值-1\" class=\"headerlink\" title=\"取值\"></a>取值</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt; zadd myset 1 hello 2 world 3 !!!</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 3</span><br><span class=\"line\">127.0.0.1:6379&gt; zcount myset 1 3 <span class=\"comment\"># 获取指定区间的成员数量</span></span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 3</span><br><span class=\"line\">127.0.0.1:6379&gt; zcount myset 1 2</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 2</span><br><span class=\"line\">127.0.0.1:6379&gt; zcount myset 1.1 3</span><br><span class=\"line\">(<span class=\"built_in\">integer</span>) 2</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"小结-1\"><a href=\"#小结-1\" class=\"headerlink\" title=\"小结\"></a>小结</h3><ul>\n<li>set 排序 存储班级成绩表 工作表排序</li>\n<li>消息普通消息 1 重要消息 2 带权重进行判断</li>\n<li>排行榜应用实现，取 Top N 测试</li>\n</ul>\n",
            "tags": []
        },
        {
            "id": "https://meteora233.github.io/2023/11/17/computer-science/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis%E5%AD%A6%E4%B9%A0/redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/",
            "url": "https://meteora233.github.io/2023/11/17/computer-science/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis%E5%AD%A6%E4%B9%A0/redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/",
            "title": "redis",
            "date_published": "2023-11-16T16:00:00.000Z",
            "content_html": "",
            "tags": []
        }
    ]
}